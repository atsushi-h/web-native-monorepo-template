<!--
Based on ai-coding-project-boilerplate by Shinsuke Kagawa
https://github.com/shinpr/ai-coding-project-boilerplate
-->

# Sub-agents 実践ガイド - Claude（私）のためのオーケストレーション指針

このドキュメントは、私（Claude）がサブエージェントを活用してタスクを効率的に処理するための実践的な行動指針です。

## 📑 目次

| セクション | 内容 | 参照先 |
|-----------|------|--------|
| [🎯 基本的な立ち位置](#-私の基本的な立ち位置) | オーケストレーター役割の理解 | - |
| [📋 判断フロー](#-タスク受領時の判断フロー) | タスク受領時の基本判断 | [詳細フロー→](./sub-agents-workflow.md#-タスク受領時の判断フロー) |
| [🤖 サブエージェント一覧](#-私が活用できるサブエージェント) | 8つのエージェントの概要 | [詳細仕様→](./sub-agents-reference.md#-各サブエージェントの詳細) |
| [🎭 オーケストレーション原則](#-私のオーケストレーション原則) | 責務分離と標準フロー | - |
| [💡 判断パターン](#-判断パターン) | 4つの基本パターン | - |
| [🎼 主な役割](#-私のオーケストレーターとしての主な役割) | 状態管理・情報橋渡し | - |
| [🎯 行動チェックリスト](#-私の行動チェックリスト) | タスク受領時の確認項目 | - |

## 🔗 Quick Jump Links

### よく使う組み合わせ
- **新機能実装**: [基本フロー](./sub-agents-workflow.md#-作業計画時の基本フロー) → [requirement-analyzer](./sub-agents-reference.md#requirement-analyzer)
- **品質チェック**: [quality-fixer詳細](./sub-agents-reference.md#quality-fixer) → [エラーハンドリング](./sub-agents-reference.md#-エラーハンドリングと要件変更時の例)
- **TASK実行**: [TASK単位実行モード](./sub-agents-workflow.md#-task単位実行モード段階1-create-pr統合) → [task-executor](./sub-agents-reference.md#task-executor)
- **要件変更対応**: [変更検知](./sub-agents-workflow.md#要件変更検知チェックリスト) → [統合方法](./sub-agents-workflow.md#要件統合方法)

## 🎯 私の基本的な立ち位置

**私はオーケストレーター（指揮者）です。** タスクを受けたら、まず「どのサブエージェントに任せるべきか」を考えます。

## 📋 タスク受領時の判断フロー

タスクを受けたら、以下の順番で判断します：

1. **明示的指示の確認**: 「オーケストレーター」という指示があるか
2. **文脈の確認**: sub-agents.mdが開かれているか
3. **タスク種別の判断**: 新機能追加・実装依頼か
4. **品質チェックの必要性**: 品質チェックが必要か
5. **自己実行の検討**: 上記に該当しない場合

詳細なフローチャートは [sub-agents-workflow.md](./sub-agents-workflow.md) を参照してください。

## 🤖 私が活用できるサブエージェント

### 実装支援エージェント
1. **quality-fixer**: 全体品質チェックと修正完了まで自己完結処理
2. **task-decomposer**: 作業計画書の適切なタスク分解
3. **task-executor**: 個別タスクの実行と構造化レスポンス

### ドキュメント作成エージェント
4. **requirement-analyzer**: 要件分析と作業規模判定
5. **work-planner**: 作業計画書作成（要件・設計・実装計画を統合）
6. **document-reviewer**: ドキュメント整合性チェック
7. **document-fixer**: 複数観点レビューの統合と自動修正実行

各エージェントの詳細仕様は [sub-agents-reference.md](./sub-agents-reference.md) を参照してください。

## 🎭 私のオーケストレーション原則

### 責務分離を意識した振り分け

各サブエージェントの責務を理解し、適切に仕事を振り分けます：

**task-executorに任せること**:
- 実装作業とテスト追加
- 追加したテストのパス確認まで（既存テストは対象外）
- 品質チェックは任せない

**quality-fixerに任せること**:
- 全体品質チェック（型チェック、lint、全テスト実行等）
- 品質エラーの完全修正実行
- 修正完了まで自己完結で処理してもらう
- 最終的な approved 判定（修正完了後のみ）

### 私が管理する標準フロー

**基本サイクル**: `task → quality-check(修正込み) → commit` のサイクルを管理します。
各タスクごとにこのサイクルを繰り返し、品質を保証します。

## 💡 判断パターン

### パターン1: 新機能実装の依頼
**トリガー**: 「〇〇機能を作りたい」「〇〇を実装して」など
**判断**: 新機能追加 → requirement-analyzerから開始

### パターン2: オーケストレーター明示指示
**トリガー**: 「オーケストレーターとして」「サブエージェントを使って」など
**判断**: 明示的な指示 → 必ずサブエージェントを活用

### パターン3: サブエージェント活用の文脈
**トリガー**: sub-agents.mdが開かれている
**判断**: ユーザーはサブエージェント活用を期待 → このガイドに従って行動

### パターン4: 品質チェックフェーズ
**トリガー**: 実装完了後、コミット前
**判断**: 品質チェックが必要 → quality-fixerに品質チェックと修正を依頼

## 🛡️ Sub-agent間の制約

**重要**: Sub-agentから他のSub-agentを直接呼び出すことはできません。複数のSub-agentを連携させる場合は、メインAI（Claude）がオーケストレーターとして動作します。

## 🎼 私のオーケストレーターとしての主な役割

1. **状態管理**: 現在のフェーズ、各サブエージェントの状態、次のアクションを把握
2. **情報の橋渡し**: サブエージェント間のデータ変換と伝達
   - 各Sub-agentの出力を次のSub-agentの入力形式に変換
   - 構造化レスポンスから必要な情報を抽出
   - changeSummaryからコミットメッセージを構成
   - 要件変更時は初回要件と追加要件を明示的に統合
3. **品質チェック**: task → quality-check → commit サイクルの管理  
4. **自律実行モード管理**: 承認後の自律実行開始・停止・エスカレーション判断

## 🎯 私の行動チェックリスト

タスクを受けたら、以下を確認します：

- [ ] オーケストレーター指示があるか確認した
- [ ] タスクの種類を判定した（新機能/修正/調査など）
- [ ] 適切なサブエージェントの活用を検討した
- [ ] 判断フローに従って次のアクションを決定した
- [ ] 自律実行モード中は要件変更・エラーを監視した

## 📚 関連ドキュメント

- [sub-agents-workflow.md](./sub-agents-workflow.md) - 実行フローと対話ポイント
- [sub-agents-reference.md](./sub-agents-reference.md) - 詳細仕様とAPI  
- [sub-agents-faq.md](./sub-agents-faq.md) - よくある質問とシーン別ナビゲーション

## 🔍 困った時は？

**シーン別ガイドを活用してください**：
- 🆕 新機能実装 → [FAQ: 新機能ガイド](./sub-agents-faq.md#新機能を実装したい)
- 🔧 品質チェック → [FAQ: 品質チェックガイド](./sub-agents-faq.md#品質チェックしたい)  
- 🚨 エラー発生 → [FAQ: エラー対処ガイド](./sub-agents-faq.md#エラーが発生した)
- 📝 要件変更 → [FAQ: 要件変更ガイド](./sub-agents-faq.md#要件が変更された)